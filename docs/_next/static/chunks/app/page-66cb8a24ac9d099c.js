(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9329:function(e,t,a){Promise.resolve().then(a.bind(a,9501))},9501:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return E}});var l=a(3827),s=a(4090);let n=["Motivation & Problem Statement","Core Methodology","Key Findings","Implications & Future Work"];function i(e){return e.replace(/\s+/g," ").trim()}function r(e){return e.toLowerCase().split(" ").map(e=>0===e.length?e:e[0].toUpperCase()+e.slice(1)).join(" ")}function o(e){return e.replace(/^\d+(?:\.\d+)*\s+/,"")}function c(e){return o(e).toLowerCase().replace(/[^a-z0-9]/g,"")}function u(e){let t=new Set,a=[];for(let l of e){let e=l.toLowerCase();t.has(e)||(t.add(e),a.push(l))}return a}function d(e){return e.replace(/\r/g," ").split(RegExp("(?<=[.!?])\\s+(?=[A-Z0-9])")).map(e=>e.replace(/\s+/g," ").trim()).filter(e=>e.length>0)}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:160;if(e.length<=t)return e;let a=e.slice(0,t-1).replace(/[,:;\-\s]+$/g,"").trim();return"".concat(a,"…")}function h(e){return e.map(e=>p(e,160)).filter(e=>!(e.length<25||/\b(doi|copyright|license|creative commons|arxiv|email|www\.)/i.test(e)))}function f(e,t){var a;let l=null!==(a=e.pageLines[0])&&void 0!==a?a:[],s=function(e,t){for(let a of[t,...e].map(e=>i(null!=e?e:"")))if(!(!a||a.length<8||/^paper$/i.test(a)))return a;return"Untitled Research Paper"}(l,e.metadata.title),f=function(e,t){if(t&&t.length>0)return t;for(let t of e.slice(1,5)){let e=i(t);if(e&&/\b(conference|journal|symposium|workshop|university|college|laboratory|institute|department)\b/i.test(e))return e}}(l,e.metadata.subject),m=function(e,t){if(t&&t.length>=4)return t;for(let t of e.slice(1,6)){let e=i(t);if(e){if(/\b(author|by|student|advisor)\b/i.test(e))return e.replace(/^(author|by)[:\s]+/i,"").trim();if(/(,| and )/.test(e)&&e.split(/\s+/).length<=15)return e}}}(l,e.metadata.author),g=function(e){if(e.length>=3)return e.slice(0,8);let t=[...n];for(let a=e.length-1;a>=0&&t.length<8;a-=1)t.splice(1,0,e[a]);return t.slice(0,6)}(function(e){let t=[],a=new Set;for(let l of e){let e=i(l);if(!e)continue;let s=e.split(/\s+/).length,n=/^\d+(\.\d+)*\s+/.test(e),o=/(introduction|background|related work|method|approach|model|experiment|evaluation|result|discussion|conclusion|future work|summary)/i.test(e),c=s<=8&&!/[.!?]$/.test(e)&&e===r(e);if(s<=2||!(n||o||c))continue;let u=e.replace(/^\d+(\.\d+)*\s+/,"").replace(/[:;,.\-\s]+$/g,"").trim(),d=u.toLowerCase();if(!(!u||u.length<3||u.length>70||a.has(d))&&(a.add(d),t.push(r(u)),t.length>=12))break}return t}(e.pageLines.flat())),x=d(e.allText),b=h(x),{sectionBullets:v,abstractBullets:w,keywordBullets:y}=function(e,t){let a=new Map;t.forEach(e=>{let t=c(e);t.length>0&&!a.has(t)&&a.set(t,e)});let l=new Map,s=[],n=[],r=(e,t)=>{l.has(e)||l.set(e,[]),l.get(e).push(t)},h=null;for(let t of e.pageLines)for(let e of t){let t=i(e);if(!t)continue;let l=c(o(t));if("abstract"===l){h="Abstract";continue}if("keywords"===l){h="Keywords";continue}let u=a.get(l);if(!u&&l.length>0){for(let[e,t]of Array.from(a.entries()))if(l.startsWith(e)||e.startsWith(l)){u=t;break}}if(u){h=u;continue}if("Abstract"===h){s.push(t);continue}if("Keywords"===h){n.push(t);continue}h&&r(h,t)}let f=new Map;for(let[e,t]of Array.from(l.entries())){let a=u(d(t.join(" "))).map(e=>p(e,150)).filter(e=>e.length>20).slice(0,5);a.length>0&&f.set(e,a)}let m=s.length>0?u(d(s.join(" "))).map(e=>p(e,150)).filter(e=>e.length>20).slice(0,5):[],g="";if(n.length>0&&(g=n.join(" ")),!g&&e.pageLines[0])for(let t of e.pageLines[0]){let e=t.match(/keywords?[:\-]?\s*(.*)/i);if(e&&e[1]){g=e[1];break}}return{sectionBullets:f,abstractBullets:m,keywordBullets:g?g.split(/[,;•]/).map(e=>i(e)).filter(e=>e.length>2&&e.length<=60).slice(0,6):[]}}(e,g),j=function(e,t){let a=new Set,l=new Set,s=e=>{let t=i(e);t.length>1&&t.length<=80&&a.add(t)},n=e=>{e.split(/,|;| and /i).map(e=>i(e)).filter(e=>e.length>1&&e.length<=80&&!/@/.test(e)).forEach(e=>s(e))};t&&n(t);let r=e.slice(0,12),o=/(university|institute|department|school|laboratory|centre|center|college|academy)/i;for(let e of r){let t=i(e);if(!(!t||t.length>120||/abstract|keywords?/i.test(t)||/@/.test(t))){if(o.test(t)){l.add(t);continue}(/,| and |;/i.test(t)||/^[A-Z][A-Za-z\-\. ]{3,}$/.test(t))&&n(t)}}let c=[];return a.forEach(e=>c.push("Author: ".concat(e))),l.forEach(e=>c.push("Affiliation: ".concat(e))),c.slice(0,6)}(l,m),k=w.length>0?w.slice(0,5):h(x).slice(0,4),N=[],P=[];j.length>0&&N.push({id:"authors-slide",title:"作者与机构",section:"Introduction",subsection:"作者与机构",blocks:[{kind:"bullets",items:j}]}),y.length>0&&N.push({id:"keywords-slide",title:"关键术语",section:"Introduction",subsection:"关键术语",blocks:[{kind:"bullets",items:y}]}),k.length>0&&(N.push({id:"abstract-slide",title:"摘要概览",section:"Introduction",subsection:"摘要概览",blocks:[{kind:"bullets",items:k.slice(0,4)}]}),k.forEach(e=>{let t=b.findIndex(t=>t===e);t>=0&&b.splice(t,1)}));let S=Math.max(3,Math.min(t-2,15)),C=Math.max(1,S-1);N.length>C&&N.splice(C);let A=Math.max(0,C-N.length);for((g.length>0?g.slice(0,Math.min(g.length,A)):n.slice(0,A)).forEach((e,t)=>{var a;let l=null!==(a=v.get(e))&&void 0!==a?a:[],s=l.length>0?l.slice(0,4):function(e,t,a){let l=e.toLowerCase(),s=[],n=0;for(;n<t.length&&s.length<a;){if(t[n].toLowerCase().includes(l)){s.push(t.splice(n,1)[0]);continue}n+=1}return s.length<a&&s.push(...t.splice(0,Math.max(0,a-s.length))),s}(e,b,4),n=s.length>0?s.map(e=>p(e,150)):["(内容待补充)"];N.push({id:"section-".concat(t+1),title:e,section:e,subsection:e,blocks:[{kind:"bullets",items:n}]})});N.length<C&&b.length>0;){let e=b.splice(0,4);if(0===e.length)break;N.push({id:"filler-".concat(N.length+1),title:"更多要点",section:"Discussion",subsection:"更多要点",blocks:[{kind:"bullets",items:e}]})}for(;N.length<C;)N.push({id:"placeholder-".concat(N.length+1),title:"内容待补充",section:"Discussion",subsection:"内容待补充",blocks:[{kind:"bullets",items:["(手动补充关键要点)"]}]});(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,a=[];for(let l=0;l<e.pageLines.length;l+=1){let s=e.pageLines[l];for(let e=0;e<s.length;e+=1){let t=i(s[e]);if(!t||!/^(fig(?:ure)?\.|figure)\b/i.test(t))continue;let n=[],r=t.replace(/^(fig(?:ure)?\.?\s*\d*[:\-]?)/i,"").trim();r.length>0&&n.push(r);for(let t=1;t<=2&&e+t<s.length;t+=1){let a=i(s[e+t]);if(!a||/^(fig(?:ure)?\.|figure)\b/i.test(a))break;n.push(a)}let o=n.join(" ").trim();a.push({pageIndex:l,caption:o.length>0?o:void 0});break}if(a.length>=t)break}return a})(e).forEach((e,t)=>{let a="figure-".concat(t+1),l=e.caption?p(e.caption,60):"图示 ".concat(t+1);P.push({id:a,pageIndex:e.pageIndex,caption:e.caption,title:l,section:"Figures",subsection:l}),N.push({id:a,title:l,section:"Figures",subsection:l,blocks:[{kind:"bullets",items:e.caption?[e.caption]:["图示说明待补充"]}]})});let L=[...N,function(e){let t=e.filter(e=>e.length>20),a=[t[0],t[Math.floor(t.length/2)],t[t.length-1]].filter(Boolean).map(e=>p(e,140));return{id:"closing-slide",title:"Takeaways & Next Steps",section:"Conclusion",blocks:[{kind:"bullets",items:a.length>=2?a:["Revisit the problem, dataset, or theoretical gap addressed by the paper.","Summarize the proposed approach and why it matters.","Highlight the most important quantitative or qualitative results."]}]}}(x)];return L.length>S&&L.splice(S),{metadata:{paperTitle:s,paperSubtitle:f,authors:m,generatedAt:new Date().toISOString(),mode:"static",slideCount:L.length+2},outline:g,slides:L,sentences:x,figures:P}}function m(e){return"图示 ".concat(e+1)}function g(e,t){let a=[...e];return t.forEach((e,t)=>{let l=function(e){if(!e)return;let t=e.trim();return t.length>0?t:void 0}(e.caption),s={kind:"image",path:"figuras/".concat(e.filename),caption:l},n=a.findIndex(t=>t.id===e.id);if(n>=0){var i,r;a[n]={...a[n],blocks:[s],section:null!==(i=a[n].section)&&void 0!==i?i:"Figures",subsection:null!==(r=a[n].subsection)&&void 0!==r?r:null!=l?l:m(t)};return}a.push({id:e.id,title:null!=l?l:m(t),section:"Figures",subsection:null!=l?l:m(t),blocks:[s]})}),a}function x(e){return e.replace(/\s+/g," ").trim()}async function b(e){if(e instanceof ArrayBuffer)return e;if(e instanceof Uint8Array)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("function"==typeof e.arrayBuffer)return await e.arrayBuffer();throw Error("Unsupported PDF source input.")}async function v(e){var t,l,s,n,i;let r,o,c,u;let d=await b(e),p=new Uint8Array(d),h=await Promise.all([a.e(651),a.e(313)]).then(a.t.bind(a,6029,23));try{let e=function(){let e=window.__NEXT_DATA__;return e&&"string"==typeof e.assetPrefix&&e.assetPrefix.length>0?e.assetPrefix.replace(/\/$/,""):""}(),t=e?"".concat(e.replace(/\/$/,""),"/pdf.worker.min.js"):"./pdf.worker.min.js";h.GlobalWorkerOptions.workerSrc=t}catch(e){}let f=h.getDocument({data:p,disableWorker:"undefined"==typeof Worker,useSystemFonts:!0}),m=await f.promise,g=[];for(let e=1;e<=m.numPages;e+=1){let t=await m.getPage(e),a=await t.getTextContent(),l=[],s="";for(let e of a.items){if(!e||"string"!=typeof e.str)continue;let t=x(e.str);t&&(s=s?"".concat(s," ").concat(t):t,e.hasEOL&&(l.push(s.trim()),s=""))}s&&l.push(s.trim()),g.push(l)}try{let e=await m.getMetadata(),a=null!==(t=null==e?void 0:e.info)&&void 0!==t?t:{};r=x(null!==(l=a.Title)&&void 0!==l?l:""),o=x(null!==(s=a.Author)&&void 0!==s?s:""),c=x(null!==(n=a.Subject)&&void 0!==n?n:""),u=x(null!==(i=a.Keywords)&&void 0!==i?i:"")}catch(e){}await m.cleanup(),await m.destroy();let v=g.flat().join("\n");return{pageLines:g,allText:v,metadata:{title:r||void 0,author:o||void 0,subject:c||void 0,keywords:u||void 0}}}async function w(e){let t=await Promise.all([a.e(651),a.e(313)]).then(a.t.bind(a,6029,23)),l=function(){let e=window.__NEXT_DATA__;return e&&"string"==typeof e.assetPrefix&&e.assetPrefix.length>0?e.assetPrefix.replace(/\/$/,""):""}(),s=l?"".concat(l.replace(/\/$/,""),"/pdf.worker.min.js"):"./pdf.worker.min.js";return t.GlobalWorkerOptions.workerSrc=s,t.getDocument({data:new Uint8Array(e),disableWorker:!0}).promise}async function y(e,t){let a=e.getViewport({scale:1.6}),l=document.createElement("canvas"),s=l.getContext("2d",{willReadFrequently:!0});return l.width=a.width,l.height=a.height,await e.render({canvasContext:s,viewport:a}).promise,new Promise((e,a)=>{l.toBlob(l=>{l?e(l):a(Error("Failed to render page ".concat(t+1)))},"image/png",.92)})}async function j(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;if(0===t.length)return[];let l=t.slice(0,a),s=await e.arrayBuffer(),n=await w(s),i=[];for(let e=0;e<l.length;e+=1){var r;let t=l[e],a=Math.max(0,Math.min(n.numPages-1,t.pageIndex)),s=await n.getPage(a+1),o=await y(s,a),c=null!==(r=t.filename)&&void 0!==r?r:"figure-".concat(a+1,"-").concat(e+1,".png");i.push({id:t.id,filename:c,caption:t.caption,pageIndex:a,blob:o})}return await n.cleanup(),await n.destroy(),i}var k=a(1101),N=a.n(k);function P(e){let t={"\\":"\\textbackslash{}","{":"\\{","}":"\\}",$:"\\$","&":"\\&","#":"\\#","%":"\\%",_:"\\_","~":"\\textasciitilde{}","^":"\\textasciicircum{}"};return e.replace(/([\\{}$&#%_~^])/g,e=>t[e])}async function S(){let e=(function(){let e=window.__NEXT_DATA__;return e&&"string"==typeof e.assetPrefix&&e.assetPrefix.length>0?e.assetPrefix.replace(/\/$/,""):""})().replace(/\/$/,""),t=e?"".concat(e,"/templates/if-beamer"):"./templates/if-beamer",a=await fetch("".concat(t,"/manifest.json"));if(!a.ok)throw Error("Unable to load template manifest.");let l=await a.json(),s=[];if(Array.isArray(l.assets))for(let e of l.assets){let a=await fetch("".concat(t,"/").concat(e));if(!a.ok)throw Error("Unable to fetch template asset: ".concat(e));let l=await a.arrayBuffer();s.push({path:e,data:l})}return s}async function C(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=f(await v(e),Math.max(8,Math.min(15,null!==(t=a.targetSlides)&&void 0!==t?t:12))),s={metadata:l.metadata,outline:l.outline,slides:l.slides,latexSource:""},n=[];if(l.figures&&l.figures.length>0)try{let t=(n=await j(e,l.figures)).map(e=>{let{id:t,filename:a,caption:l}=e;return{id:t,filename:a,caption:l}});l.figures=l.figures.map(e=>{let a=t.find(t=>t.id===e.id);return a?{...e,filename:a.filename}:e}),s.slides=g(s.slides,t),s.metadata.slideCount=s.slides.length+2}catch(e){console.warn("[Paper2PPT] Failed to extract figure images",e)}let i=function(e){var t,a,l;let s,n;let{metadata:i,outline:r,slides:o}=e,c=[],u=(null===(t=i.authors)||void 0===t?void 0:t.trim().length)?i.authors:"Automated Summary",d=(null===(a=i.paperSubtitle)||void 0===a?void 0:a.trim().length)?i.paperSubtitle:"Generated by Paper2PPT";if(c.push("\n% Auto-generated by Paper2PPT"),c.push("\\documentclass{if-beamer}"),c.push(""),c.push("\\title["+P((l=i.paperTitle).length<=60?l:"".concat(l.slice(0,57),"..."))+"]{"+"\\textbf{".concat(P(i.paperTitle),"}")+"}"),c.push("\\subtitle{"+P(d)+"}"),c.push("\\author[]{\\large \\negrito{"+P(u)+"}}"),c.push("\\institute[]{"),c.push("  \\small \\textit{Paper2PPT Auto-generated Deck} \\"),c.push("  \\textit{https://github.com/greyyy/Paper2PPT}"),c.push("}"),c.push("\\date{\\today}"),c.push("\\logo{"),c.push("  \\includegraphics[scale=.15, clip]{figuras/logoPPGCA.png}"),c.push("}"),c.push("\\subject{"+P(i.paperTitle)+"}"),c.push("\\graphicspath{{figuras/}}"),c.push(""),c.push("\\begin{document}"),c.push(""),c.push("\\begin{frame}"),c.push("  \\titlepage"),c.push("\\end{frame}"),c.push(""),c.push("\\begin{frame}{Agenda}"),r.length>0){for(let e of(c.push("  \\begin{itemize}"),r.slice(0,8)))c.push("    \\item "+P(e));c.push("  \\end{itemize}")}else c.push("  \\tableofcontents");for(let e of(c.push("\\end{frame}"),c.push(""),o))e.section&&e.section!==s&&(c.push("\\section{"+P(e.section)+"}"),c.push(""),s=e.section,n=void 0),e.subsection&&e.subsection!==n&&(c.push("\\subsection{"+P(e.subsection)+"}"),c.push(""),n=e.subsection),c.push(function(e){let t=["\\begin{frame}{".concat(P(e.title),"}")];for(let a of e.blocks)t.push(function(e){if("paragraph"===e.kind)return"".concat(P(e.text),"\\par");if("quote"===e.kind)return["\\begin{quote}",P(e.text),"\\end{quote}"].join("\\n");if("image"===e.kind){var t;let a=null!==(t=e.width)&&void 0!==t?t:"0.9\\textwidth",l=["\\begin{figure}[h]","  \\centering","  \\includegraphics[width=".concat(a,"]{").concat(e.path,"}")];return e.caption&&e.caption.trim().length>0&&l.push("  \\caption{".concat(P(e.caption),"}")),l.push("\\end{figure}"),l.join("\\n")}let a=e.items.filter(e=>e.trim().length>0).map(e=>"  \\item ".concat(P(e.trim())));return 0===a.length&&a.push("  \\item (content placeholder)"),["\\begin{itemize}",...a,"\\end{itemize}"].join("\\n")}(a));return e.notes&&t.push("\\note{".concat(P(e.notes),"}")),t.push("\\end{frame}"),t.join("\n")}(e)),c.push("");return c.push("\\end{document}\n"),c.join("\n")}({metadata:s.metadata,outline:s.outline,slides:s.slides});s.latexSource=i;let r=await S(),o=new(N());for(let e of(o.file("main.tex",i),r))o.file(e.path,e.data,{binary:!0});for(let e of n)o.file("figuras/".concat(e.filename),e.blob,{binary:!0});let c=s.metadata.paperTitle.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/-{2,}/g,"-").replace(/^-|-$/g,"").slice(0,48)||"paper2ppt",u=new Date().toISOString().replace(/[:T]/g,"-").split(".")[0],d="Paper2PPT-".concat(c,"-").concat(u,".zip");return{deck:s,zipBlob:await o.generateAsync({type:"blob"}),zipFilename:d}}let A={openai:{label:"OpenAI / 兼容接口",defaultBaseUrl:"https://api.openai.com/v1",models:[{value:"gpt-4o",label:"gpt-4o (2024)"},{value:"gpt-4o-mini",label:"gpt-4o-mini (高性价比)"},{value:"gpt-4.1",label:"gpt-4.1"},{value:"gpt-4.1-mini",label:"gpt-4.1-mini"},{value:"o1",label:"o1 (推理)"},{value:"o1-mini",label:"o1-mini"}]},anthropic:{label:"Anthropic Claude",defaultBaseUrl:"https://api.anthropic.com/v1",models:[{value:"claude-3.5-sonnet-20240620",label:"Claude 3.5 Sonnet (2024-06-20)"},{value:"claude-3.5-haiku-20240620",label:"Claude 3.5 Haiku (2024-06-20)"},{value:"claude-3-opus-20240229",label:"Claude 3 Opus (2024-02-29)"},{value:"claude-3-sonnet-20240229",label:"Claude 3 Sonnet (2024-02-29)"}],helper:"Anthropic 需传 x-api-key 且会自动添加 anthropic-version: 2023-06-01"},azure:{label:"Azure OpenAI",defaultBaseUrl:"https://{your-resource-name}.openai.azure.com/openai",models:[{value:"gpt-4o",label:"gpt-4o (deployment name)"},{value:"gpt-4o-mini",label:"gpt-4o-mini"},{value:"gpt-35-turbo",label:"gpt-35-turbo"}],helper:"Azure 需在 Base URL 中包含资源名，并在 URL 查询参数附加 api-version"},deepseek:{label:"DeepSeek",defaultBaseUrl:"https://api.deepseek.com/v1",models:[{value:"deepseek-chat",label:"deepseek-chat (对话)"},{value:"deepseek-reasoner",label:"deepseek-reasoner (推理)"}]},custom:{label:"自定义兼容接口",models:[],helper:"完全自定义的 OpenAI-Compatible 服务，可自由填写 Base URL 与模型名"}},L="rounded-3xl border border-white/60 bg-white/90 p-6 shadow-[0_28px_60px_-30px_rgba(30,41,59,0.45)] backdrop-blur-xl",_=["static"];function U(e,t){let[a,l]=(0,s.useState)(()=>{var a;return null!==(a=window.localStorage.getItem(e))&&void 0!==a?a:t});return(0,s.useEffect)(()=>{window.localStorage.setItem(e,a)},[e,a]),[a,l]}function E(){var e,t,a;let[n,i]=(0,s.useState)("static"),[r,o]=(0,s.useState)(null),[c,u]=(0,s.useState)(12),[d,p]=(0,s.useState)("openai"),[h,m]=(0,s.useState)(null!==(t=null===(e=A.openai.models[0])||void 0===e?void 0:e.value)&&void 0!==t?t:""),[x,b]=(0,s.useState)(0===A.openai.models.length),[w,y]=U("paper2ppt-api-key",""),[k,N]=U("paper2ppt-api-base","https://api.openai.com/v1"),[P,S]=U("paper2ppt-custom-prompt",'Structure the deck into the following thematic order and only create additional slides when strictly necessary:\n1. Motivation\n2. Method\n3. Experiments\n4. Results\n5. Discussion\n6. Conclusion\n\nWhen producing the JSON response:\n- Set the "section" field to one of the headings above in the same order.\n- For every slide provide a "subsection" string; this will become a LaTeX \\subsection{}.\n- Each slide must contain 4–6 bullet points that capture concrete technical details (datasets, metrics, numerical values, qualitative observations, limitations, implications, etc.).\n- Bullets should be declarative sentences under 26 words, without trailing punctuation or numbering, and use active voice.\n- Define new terminology or abbreviations the first time they appear.\n- Add up to 3 sentences of speaker notes when they help explain transitions or interpret results.\n- Respect the requested slide count exactly (excluding title and agenda frames). If information is sparse, merge concepts rather than invent content.\n- Prefer plain text. Use inline LaTeX math $...$ only when formulas or symbols are essential.\n- Highlight limitations or future work explicitly in the Discussion slide and summarise actionable insights in the Conclusion slide.\n- When image assets are listed, integrate them using LaTeX figure syntax (\\begin{figure}[h] ... \\includegraphics{figuras/filename} ... \\end{figure}), and refer to them in nearby bullets.\n'),[E,T]=(0,s.useState)([]),[I,M]=(0,s.useState)(!1),[B,D]=(0,s.useState)(""),[F,O]=(0,s.useState)(null),[R,z]=(0,s.useState)(null),[$,W]=(0,s.useState)(null),[q,X]=(0,s.useState)("Paper2PPT.zip");(0,s.useEffect)(()=>()=>{$&&URL.revokeObjectURL($)},[$]),(0,s.useEffect)(()=>{let e=A[d];if(e.models.length>0){var t,a;b(!1),m(null!==(a=null===(t=e.models[0])||void 0===t?void 0:t.value)&&void 0!==a?a:"")}else b(!0),m("");"string"==typeof e.defaultBaseUrl&&N(e.defaultBaseUrl)},[d,N]);let G=A[d],Z=(0,s.useMemo)(()=>{var e;return null!==(e=null==R?void 0:R.outline)&&void 0!==e?e:[]},[R]),H=(0,s.useCallback)(e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){if("application/pdf"!==a.type){O("请上传 PDF 文件。");return}o(a),O(null)}},[]),K=(0,s.useCallback)(async()=>{if(!r){O("请先选择一份论文 PDF。");return}M(!0),D("解析 PDF 并生成初稿…"),O(null);try{let{deck:e,zipBlob:t,zipFilename:a}=await C(r,{targetSlides:c});z(e),$&&URL.revokeObjectURL($);let l=URL.createObjectURL(t);W(l),X(a),D("生成完成，可下载 ZIP 或进一步编辑。")}catch(e){console.error(e),O(e instanceof Error?e.message:"静态生成失败，请稍后再试。")}finally{M(!1)}},[r,c,$]),J=(0,s.useCallback)(async()=>{if(!r){O("请先选择一份论文 PDF。");return}if(!w.trim()){O("请输入有效的大模型 API Key。");return}if(!h.trim()){O("请选择或填写模型名称。");return}if(!k.trim()){O("请填写 API Base URL。");return}M(!0),D("解析 PDF 并准备上下文…"),O(null);try{var e,t,a,l;let s=await v(r),n=f(s,c),i=await j(r,null!==(e=n.figures)&&void 0!==e?e:[]),o=i.map(e=>({id:e.id,filename:e.filename,caption:e.caption})),u=E.map((e,t)=>({id:e.id,filename:e.filename,caption:e.caption,order:t}));n.figures&&(n.figures=n.figures.map(e=>{let t=o.find(t=>t.id===e.id);return t?{...e,filename:t.filename}:e}));let p=u.map(e=>({id:e.id,pageIndex:0,caption:e.caption,title:e.caption||e.filename,section:"Figures",subsection:e.caption||e.filename,filename:e.filename}));n.figures=[...null!==(t=n.figures)&&void 0!==t?t:[],...p];let m=[...o,...u].map(e=>{let{id:t,filename:a,caption:l}=e;return{id:t,filename:a,caption:l}}),x=g(n.slides,m);n.slides=x;let b=JSON.stringify(n);z({metadata:n.metadata,outline:n.outline,slides:x,latexSource:""});let y=new FormData;y.append("mode","llm"),y.append("provider",d),y.append("model",h),y.append("apiBaseUrl",k),y.append("targetSlides",String(c)),y.append("file",r),y.append("baseline",b),y.append("figureMeta",JSON.stringify(null!==(a=n.figures)&&void 0!==a?a:[])),y.append("figUploadsMeta",JSON.stringify(u.map(e=>{let{id:t,filename:a,caption:l}=e;return{id:t,filename:a,caption:l}}))),i.forEach(e=>{y.append("figures",e.blob,e.filename)}),E.forEach(e=>{y.append("figUploads",e.file,e.filename)}),y.append("prompt",P),D("调用大模型生成摘要与幻灯片结构…");let N=await fetch("/api/generate",{method:"POST",headers:{Authorization:"Bearer ".concat(w.trim())},body:y});if(!N.ok){let e=await N.text();throw Error(e||"服务端生成失败，请稍后再试。")}let S=await N.json();S.deck&&z(S.deck),$&&URL.revokeObjectURL($);let C=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/zip",a=atob(e),l=a.length,s=new Uint8Array(l);for(let e=0;e<l;e+=1)s[e]=a.charCodeAt(e);return new Blob([s],{type:t})}(S.zipBase64),A=URL.createObjectURL(C);W(A),X(null!==(l=S.filename)&&void 0!==l?l:"Paper2PPT-".concat(Date.now(),".zip")),D("生成完成，可下载 ZIP。")}catch(e){console.error(e),O(e instanceof Error?e.message:"调用大模型失败，请检查参数。")}finally{M(!1)}},[r,w,d,h,k,c,P,$,E]),V=(0,s.useCallback)(e=>{let t=e.target.value;if("__custom__"===t){b(!0),m("");return}b(!1),m(t)},[]),Q=(0,s.useCallback)(e=>{let t=e.target.files;if(!t||0===t.length)return;let a=Array.from(t).map(e=>({id:crypto.randomUUID(),file:e,filename:"".concat(Date.now(),"-").concat(e.name.replace(/\s+/g,"_")),caption:""}));T(e=>[...e,...a]),e.target.value=""},[]),Y=(0,s.useCallback)((e,t)=>{T(a=>a.map(a=>a.id===e?{...a,caption:t}:a))},[]),ee=(0,s.useCallback)(e=>{T(t=>t.filter(t=>t.id!==e))},[]),et=(0,s.useCallback)(async()=>{"static"===n?await K():await J()},[n,K,J]),ea=$?(0,l.jsx)("a",{href:$,download:q,className:"inline-flex items-center justify-center rounded-full bg-slate-900 px-5 py-2 text-sm font-semibold text-white shadow-lg transition hover:bg-slate-700",children:"下载 ZIP"}):null;return(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("section",{className:"".concat(L," space-y-6"),children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,l.jsx)("div",{className:"flex gap-2 rounded-full bg-slate-100 p-1 text-sm font-semibold",children:_.map(e=>(0,l.jsx)("button",{type:"button",onClick:()=>i(e),className:"rounded-full px-4 py-1 transition ".concat(n===e?"bg-white text-slate-900 shadow-inner":"text-slate-500"),children:"static"===e?"静态生成（离线可用）":"LLM 驱动（高质量）"},e))}),(0,l.jsx)("span",{className:"rounded-full bg-slate-200 px-3 py-1 text-xs text-slate-600",children:"GitHub Pages 版本仅提供静态生成，如需调用大模型请在本地运行。"}),(0,l.jsxs)("div",{className:"flex items-center gap-3 text-xs text-slate-500",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("div",{className:"h-2 w-2 rounded-full bg-emerald-500"}),"静态版：浏览器内解析"]}),!1,(0,l.jsx)("a",{href:"https://github.com/Greyyy-HJC/Paper2PPT",target:"_blank",rel:"noreferrer",className:"inline-flex items-center rounded-full border border-slate-200 px-2 py-1 font-medium text-slate-500 transition hover:border-slate-300 hover:text-slate-700",children:"GitHub 仓库"})]})]}),(0,l.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[1.4fr_1fr]",children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("label",{htmlFor:"pdf-upload",className:"block cursor-pointer rounded-2xl border border-dashed border-slate-300 bg-white/70 p-8 text-center transition hover:border-slate-400 hover:bg-white",children:[(0,l.jsx)("input",{id:"pdf-upload",type:"file",accept:"application/pdf",className:"hidden",onChange:H}),(0,l.jsx)("p",{className:"text-base font-medium text-slate-800",children:r?r.name:"点击上传论文 PDF"}),(0,l.jsx)("p",{className:"mt-2 text-xs text-slate-500",children:"文件仅在浏览器中处理，不会上传至服务器（除非启用 LLM 模式）。"})]}),(0,l.jsxs)("div",{className:"rounded-2xl bg-slate-50 p-4",children:[(0,l.jsxs)("label",{className:"flex items-center justify-between text-sm text-slate-600",children:[(0,l.jsx)("span",{children:"目标幻灯片页数"}),(0,l.jsx)("span",{className:"font-semibold text-slate-900",children:c})]}),(0,l.jsx)("input",{type:"range",min:8,max:18,value:c,onChange:e=>u(Number(e.target.value)),className:"mt-3 w-full"})]})]}),(0,l.jsx)("div",{className:"space-y-4 rounded-2xl bg-slate-50 p-4",children:"llm"===n?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("label",{className:"block space-y-2 text-sm text-slate-600",children:[(0,l.jsx)("span",{children:"模型服务提供商"}),(0,l.jsx)("select",{value:d,onChange:e=>p(e.target.value),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm focus:border-slate-400 focus:outline-none",children:Object.entries(A).map(e=>{let[t,a]=e;return(0,l.jsx)("option",{value:t,children:a.label},t)})}),G.helper&&(0,l.jsx)("span",{className:"block text-xs text-slate-400",children:G.helper})]}),(0,l.jsxs)("label",{className:"block space-y-2 text-sm text-slate-600",children:[(0,l.jsx)("span",{children:"API Key"}),(0,l.jsx)("input",{type:"password",value:w,onChange:e=>y(e.target.value),placeholder:"sk-...",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm focus:border-slate-400 focus:outline-none"}),(0,l.jsx)("span",{className:"text-xs text-slate-400",children:"保存在浏览器 LocalStorage，仅用于当前机器。"})]}),(0,l.jsxs)("div",{className:"space-y-2 text-sm text-slate-600",children:[(0,l.jsx)("span",{className:"block",children:"模型"}),G.models.length>0?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("select",{value:x?"__custom__":h,onChange:V,className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm focus:border-slate-400 focus:outline-none",children:[G.models.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value)),(0,l.jsx)("option",{value:"__custom__",children:"自定义模型…"})]}),x&&(0,l.jsx)("input",{type:"text",value:h,onChange:e=>m(e.target.value),placeholder:"输入自定义模型名称",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm focus:border-slate-400 focus:outline-none"})]}):(0,l.jsx)("input",{type:"text",value:h,onChange:e=>m(e.target.value),placeholder:"输入模型名称",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm focus:border-slate-400 focus:outline-none"})]}),(0,l.jsxs)("label",{className:"block space-y-2 text-sm text-slate-600",children:[(0,l.jsx)("span",{children:"API Base URL"}),(0,l.jsx)("input",{type:"text",value:k,onChange:e=>N(e.target.value),placeholder:null!==(a=G.defaultBaseUrl)&&void 0!==a?a:"https://...",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm focus:border-slate-400 focus:outline-none"})]}),(0,l.jsxs)("label",{className:"block space-y-2 text-sm text-slate-600",children:[(0,l.jsx)("span",{children:"提示词（可选）"}),(0,l.jsx)("textarea",{value:P,onChange:e=>S(e.target.value),rows:6,className:"w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm focus:border-slate-400 focus:outline-none font-mono"}),(0,l.jsx)("span",{className:"block text-xs text-slate-400",children:"默认提示词会引导模型解释概念、覆盖方法与结果，你也可以在此基础上追加或修改要求。"})]}),(0,l.jsxs)("div",{className:"space-y-2 text-sm text-slate-600",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"font-semibold text-slate-700",children:"附加配图（可选）"}),(0,l.jsxs)("label",{className:"inline-flex cursor-pointer rounded-xl border border-slate-200 bg-white px-3 py-1 text-xs font-medium text-slate-600 shadow-sm transition hover:border-slate-300",children:["上传图片",(0,l.jsx)("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:Q})]})]}),(0,l.jsx)("span",{className:"text-xs text-slate-400",children:"图片将打包到 ZIP 的 `figuras/` 目录，并在 LLM 输出的 LaTeX 中引用；建议提前裁剪为幻灯片适合的尺寸。"}),E.length>0&&(0,l.jsx)("div",{className:"space-y-2",children:E.map((e,t)=>(0,l.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-3 text-xs text-slate-600 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("span",{className:"font-semibold text-slate-700",children:["图片 ",t+1,": ",e.filename]}),(0,l.jsx)("button",{type:"button",onClick:()=>ee(e.id),className:"text-xs font-semibold text-slate-400 transition hover:text-red-500",children:"移除"})]}),(0,l.jsx)("input",{type:"text",value:e.caption,onChange:t=>Y(e.id,t.target.value),placeholder:"为该图片填写一句话描述，帮助模型理解与引用",className:"mt-2 w-full rounded-lg border border-slate-200 px-2 py-1 text-sm text-slate-700 focus:border-slate-400 focus:outline-none"})]},e.id))})]})]}):(0,l.jsxs)("div",{className:"space-y-2 text-sm text-slate-600",children:[(0,l.jsx)("p",{className:"font-semibold text-slate-800",children:"静态生成说明"}),(0,l.jsxs)("ul",{className:"list-disc space-y-1 pl-5 text-xs text-slate-500",children:[(0,l.jsx)("li",{children:"直接在浏览器中解析 PDF，提取标题、章节与要点。"}),(0,l.jsx)("li",{children:"按照 IF-Beamer 模版生成 LaTeX 文件并打包。"}),(0,l.jsx)("li",{children:"生成的内容适合作为初稿，可手动进一步润色。"})]})]})})]}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,l.jsx)("button",{type:"button",onClick:et,disabled:I,className:"inline-flex items-center justify-center rounded-full bg-blue-600 px-6 py-2 text-sm font-semibold text-white shadow-lg transition hover:bg-blue-500 disabled:cursor-not-allowed disabled:bg-blue-300",children:I?"生成中…":"static"===n?"生成静态幻灯片":"调用 LLM 生成"}),ea,B&&(0,l.jsx)("p",{className:"text-xs text-slate-500",children:B})]}),F&&(0,l.jsx)("div",{className:"rounded-2xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-600",children:F})]}),R&&(0,l.jsxs)("section",{className:"".concat(L," space-y-6"),children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"生成概要"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-slate-500",children:R.metadata.paperTitle}),R.metadata.authors&&(0,l.jsx)("p",{className:"text-xs text-slate-400",children:R.metadata.authors})]}),Z.length>0&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-slate-700",children:"Outline"}),(0,l.jsx)("ul",{className:"mt-2 grid gap-2 text-sm text-slate-600 sm:grid-cols-2",children:Z.map((e,t)=>(0,l.jsxs)("li",{className:"rounded-xl bg-slate-100 px-3 py-2",children:[t+1,". ",e]},e+t))})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-slate-700",children:"Slides Preview"}),(0,l.jsx)("div",{className:"grid gap-3 md:grid-cols-2",children:R.slides.map(e=>(0,l.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 text-sm text-slate-600 shadow-sm",children:[(0,l.jsx)("p",{className:"font-semibold text-slate-800",children:e.title}),e.section&&(0,l.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:e.section}),(0,l.jsx)("ul",{className:"mt-2 list-disc space-y-1 pl-5",children:e.blocks.filter(e=>"bullets"===e.kind).flatMap(e=>"bullets"===e.kind?e.items:[]).slice(0,4).map((t,a)=>(0,l.jsx)("li",{children:t},"".concat(e.id,"-").concat(a)))})]},e.id))})]})]})]})}}},function(e){e.O(0,[701,565,249,971,69,744],function(){return e(e.s=9329)}),_N_E=e.O()}]);